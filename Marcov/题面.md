# 题面

圆上有一个动点，它有个初始位置。在每一个时刻，它会等概率地顺时针或者逆时针转动$\frac{2}{3} \pi$，设在时刻$n$它停在初始位置的概率为$P_n$

(1) 求${P_n}$通项公式。

(2) 求$P_n$的前$n$项和$S_n$。

## 解决方案

发现动点只有三个位置：$0, \frac{2}{3} \pi, \frac{4}{3} \pi$，我们将这三个位置表示为$r_0, r_1, r_2$。

扩展题中概率$P_t$为$P_t(x), x \in \{ 0, 1, 2 \}$，表示动点在时刻$t$时在位置$r_x$的概率。有如下概率转化方程：

$$ \begin{cases} P_{t+1}(0) = \frac{1}{2}P_{t}(1) + \frac{1}{2}P_{t}(1) \\ P_{t+1}(1) = \frac{1}{2}P_{t}(0) + \frac{1}{2}P_{t}(2) \\ P_{t+1}(2) = \frac{1}{2}P_{t}(0) + \frac{1}{2}P_{t}(1) \end{cases}$$

于是有：

$$
\begin{aligned}
    \begin{bmatrix} P_{t+1}(0) \\ P_{t+1}(1) \\ P_{t+1}(2) \end{bmatrix} &= \begin{bmatrix} 0 & \frac{1}{2} & \frac{1}{2} \\ \frac{1}{2} & 0 & \frac{1}{2} \\ \frac{1}{2} & \frac{1}{2} & 0 \end{bmatrix} \begin{bmatrix} P_{t}(0) \\ P_{t}(1) \\ P_{t}(2) \end{bmatrix} \\
    &= \begin{bmatrix} 0 & \frac{1}{2} & \frac{1}{2} \\ \frac{1}{2} & 0 & \frac{1}{2} \\ \frac{1}{2} & \frac{1}{2} & 0 \end{bmatrix}^{t+1} \begin{bmatrix} P_{0}(0) \\ P_{0}(1) \\ P_{0}(2) \end{bmatrix}
\end{aligned} \\
\begin{bmatrix} P_{t}(0) \\ P_{t}(1) \\ P_{t}(2) \end{bmatrix} = \begin{bmatrix} 0 & \frac{1}{2} & \frac{1}{2} \\ \frac{1}{2} & 0 & \frac{1}{2} \\ \frac{1}{2} & \frac{1}{2} & 0 \end{bmatrix}^{t} \begin{bmatrix} P_{0}(0) \\ P_{0}(1) \\ P_{0}(2) \end{bmatrix} \tag{1} $$

其中，$P_0$表示初始状态，即$P_0(0) = 1, P_0(1) = 0, P_0(2) = 0$。

令$\textbf{A} = \begin{bmatrix} 0 & \frac{1}{2} & \frac{1}{2} \\ \frac{1}{2} & 0 & \frac{1}{2} \\ \frac{1}{2} & \frac{1}{2} & 0 \end{bmatrix}$，计算$A$的特征值：

$$|\lambda \textbf{I} - \textbf{A}| = 0 \\
\Rightarrow (\lambda + \frac{1}{2})^2(\lambda - 1) = 0 \\
\Rightarrow \lambda_1 = \lambda_2 = - \frac{1}{2}, \lambda _3 = 1$$

对应特征向量：$\boldsymbol{\alpha}_1 = (-1,1,0)^T, \boldsymbol{\alpha} _2 = (-1,0,1)^T, \boldsymbol{\alpha} _3 = (1,1,1)^T$

令$\textbf{U} = (\boldsymbol{\alpha} _1, \boldsymbol{\alpha} _2, \boldsymbol{\alpha} _3)$，有：
$$
\begin{aligned}
    \textbf{AU} &= (\lambda _1 \boldsymbol{\alpha_1}, \lambda _2 \boldsymbol{\alpha_2}, \lambda _3 \boldsymbol{\alpha_3}) \\
    &= \textbf{U}\begin{bmatrix} \lambda _1 & & \\ & \lambda_2 & \\ & & \lambda _3 \end{bmatrix}
\end{aligned} \\
\textbf{A} = \textbf{U} ^{-1} \begin{bmatrix} \lambda_1 & & \\ & \lambda _2 & \\ & & \lambda_3 \end{bmatrix} \textbf{U}$$

其中，可以计算得出：

$$
\boldsymbol{U}^{-1} =
\begin{bmatrix}
-\frac{1}{3} & \frac{2}{3} & -\frac{1}{3} \\[0.5em]
-\frac{1}{3} & -\frac{1}{3} & \frac{2}{3} \\[0.5em]
\frac{1}{3} & \frac{1}{3} & \frac{1}{3}
\end{bmatrix}$$

代入公式$(1)$，替换$\textbf{A}$，得：

$$\begin{aligned}
    \begin{bmatrix} P_{t}(0) \\ P_{t}(1) \\ P_{t}(2) \end{bmatrix} &= (\textbf{U}^{-1} \begin{bmatrix} \lambda _1 & & \\ & \lambda _2 & \\ & & \lambda _3 \end{bmatrix} \textbf{U})^{t} \begin{bmatrix} P_{0}(0) \\ P_{0}(1) \\ P_{0}(2) \end{bmatrix} \\
    &= \textbf{U}^{-1} \begin{bmatrix} \lambda _1 & & \\ & \lambda _2 & \\ & & \lambda _3 \end{bmatrix} ^t \textbf{U} \begin{bmatrix} P_{0}(0) \\ P_{0}(1) \\ P_{0}(2) \end{bmatrix}
\end{aligned}$$

代入所有值，有：

$$P_t(0) = \frac{1}{3} + \frac{2}{3} (- \frac{1}{2})^t
$$

至于前缀和，根据等比数列求和公式就可以算：

$$S_n = \frac{n}{3} - \frac{2}{9}(- \frac{1}{2})^n$$
